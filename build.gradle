plugins {
    id 'distribution'
    id 'java'
}

repositories {
    mavenLocal()
    mavenCentral()
    maven {
        url "https://oss.jfrog.org/jfrog-dependencies"
    }
}



group = "io.pravega"
version = releaseVersion

description = "Boomi Pravega Connector"
sourceCompatibility = 1.8
targetCompatibility = 1.8

configurations {
    localDeps
    runtime.exclude group: "io.netty", module: "netty-tcnative-boringssl-static"
}


dependencies {
    compile ("io.pravega:pravega-client:${pravegaVersion}"){
        exclude group: "io.netty", module: "netty-tcnative-boringssl-static"
    }
    //compile "io.pravega:pravega-client:${pravegaVersion}"
    compile "io.pravega:pravega-keycloak-client:${pravegaKeycloakVersion}"
    compile "com.jayway.jsonpath:json-path:${jsonPathVersion}"
    localDeps "com.boomi:connector-sdk-util:${boomiConnectorVersion}"
    compileOnly "com.boomi:common-sdk:${boomiCommonSdkVersion}"
    compileOnly "com.boomi:connector-sdk-api:${boomiConnectorVersion}"
    testImplementation "org.junit.jupiter:junit-jupiter:5.5.2"
    testCompile "io.pravega:pravega-standalone:${pravegaVersion}"
    testCompile "com.boomi:boomi-util:${boomiUtilVersion}"
    testCompile "com.boomi:common-sdk:${boomiCommonSdkVersion}"
    testCompile "com.boomi:connector-sdk-api:${boomiConnectorVersion}"
    testCompile "com.boomi:connector-sdk-test-util:${boomiConnectorVersion}"
    testCompile "org.slf4j:slf4j-api:1.7.9"
    testCompile "ch.qos.logback:logback-core:1.2.3"
    testRuntime "ch.qos.logback:logback-classic:1.2.3"
    compile configurations.localDeps

}


distributions {
    main {
        baseName = archivesBaseName
        contents {
            into('META-INF') {
                from(project.file('src/main/resources/connector-config.xml'))
            }
            into('lib') {
                from configurations.runtime
                from jar
            }
            into '/'
        }

    }


}

test {
    useJUnitPlatform()
    systemProperties 'singlenode.configurationFile': project.file('src/test/resources/standalone-config.properties')
}
